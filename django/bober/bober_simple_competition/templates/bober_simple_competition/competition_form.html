{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% load admin_static %}
{% static 'admin' %}
{% block title %}{% trans "Edit competition" %}{% endblock %}

{% block headline %}{% trans "Edit competition" %}{% endblock %}
{% block extrahead %}
<link rel="stylesheet" type="text/css" href="{% static "admin/css/base.css" %}" />
<link rel="stylesheet" type="text/css" href="{% static "admin/css/changelists.css" %}" />
<link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}" />
<script type="text/javascript" src="{% url 'admin:jsi18n' %}"></script>
<script type="text/javascript">window.__admin_media_prefix__ = "{% filter escapejs %}{% static "admin/" %}{% endfilter %}";</script>
<!--[if lte IE 7]><link rel="stylesheet" type="text/css" href="{% block stylesheet_ie %}{% static "admin/css/ie.css" %}{% endblock %}" /><![endif]-->
{% if LANGUAGE_BIDI %}<link rel="stylesheet" type="text/css" href="{% block stylesheet_rtl %}{% static "admin/css/rtl.css" %}{% endblock %}" />{% endif %}
<script type="text/javascript" src="{% static "admin/js/vendor/jquery/jquery.js" %}"></script>
<script type="text/javascript" src="{% static "admin/js/jquery.init.js" %}"></script>
<script type="text/javascript" src="{% static "admin/js/actions.js" %}"></script>
<script type="text/javascript" src="{% static "admin/js/inlines.js" %}"></script>
<script type="text/javascript" src="{% static "admin/js/admin/RelatedObjectLookups.js" %}"></script>
<script type="text/javascript" src="{% static "admin/js/core.js" %}"></script>
{{form.media}}
{% endblock %}
{% block content %}
<br>
<script>
$( document ).ready(function() {
  {% if request.profile.feature_level == 0 %}
    var userType = "reduced"
  {% elif request.profile.feature_level == 1 %}
    var userType = "basic"
  {% elif request.profile.feature_level == 10 %}
    var userType = "common"
  {% else %}
    var userType = "all"
  {% endif %}

  if (userType == "basic") {
    $( "#normal_form_fields" ).remove();
    $('#content').append('<p> {% trans "Sorry, you dont have a permission." %}<a href="/"> {% trans "Go back." %} <a></p>');
  }
  else if (userType == 'reduced') {
  }
  else if (userType == 'common') {
    //do something
  }
  else {
    return;
  }

  $('#add_more').click(function() {
        cloneMore('.questionsets table tbody:last', 'competitionquestionset_set');
    });

    function cloneMore(selector, type) {
      var newElement = $(selector).clone(true);
      var total = $('#id_' + type + '-TOTAL_FORMS').val();
      newElement.find(':input').each(function() {
          var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
          var id = 'id_' + name;
          $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
      });
      newElement.find('label').each(function() {
          var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');
          $(this).attr('for', newFor);
      });
      total++;
      $('#id_' + type + '-TOTAL_FORMS').val(total);
      $(selector).after(newElement);
  }

});

</script>
<form action="" method="post">
{% csrf_token %}
{{ CompetitionCreateFormSet.management_form }}
{{ form.non_field_errors }}
<div id="normal_form_fields" class="form_table toLeft">
  <div class="row">
    <p class="questionsets_head">
      {% trans "Create New Competition" %}
    </p>
    <div class="col-md-12 left_set">
    <table>
<<<<<<< Updated upstream
            {{ form }}
=======
      {{form}}
>>>>>>> Stashed changes
    </table>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 left_set questionsets" id="questionsets">
      <p class="questionsets_head">
        {% trans "Question sets" %}
      </p>
      {% for inline in inlines %}
          {{inline.management_form}}
          {% for form in inline %}
            <table>
              {{ form }}
            </table>
          {% endfor %}
      {% endfor %}
    </div>
  </div>
  <div class="row" style="margin-top:2%;">
<<<<<<< Updated upstream
    <a class="add_row" id="add_more">Add Another Competition Questionset</a>
=======
    <a class="add_row" style="background: url(/static/admin/img/icon-addlink.svg) 0 1px no-repeat;
padding-left: 16px; font-size:15px!important; margin-left:1%; cursor:pointer;">  {% trans "Add Another Competition Questionset" %}</a>
>>>>>>> Stashed changes
  </div>
  <input class="submit_set btn btn-success" type="submit" value='{% trans "Submit" %}' />
</div>
</form>
{% endblock %}
